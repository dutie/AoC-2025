name: Update README ⭐

on:
  # Runs daily at 6 AM UTC during December 1-25
  schedule:
    - cron: "0 6 1-25 12 *"
  
  # Run on push to main branch (updates stars when you push solutions)
  push:
    branches:
      - main
    paths:
      - "src/**"  # Only trigger when solution files change
  
  # Allow manual trigger from Actions tab
  workflow_dispatch:

jobs:
  update-readme:
    # Only run if AOC_ENABLED variable is set to 'true'
    if: ${{ vars.AOC_ENABLED == 'true' }}
    runs-on: ubuntu-latest
    
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Update README with star progress
        uses: k2bd/advent-readme-stars@v1
        with:
          userId: ${{ secrets.AOC_USER_ID }}
          sessionCookie: ${{ secrets.AOC_SESSION }}
          year: ${{ secrets.AOC_YEAR }}
          # Optional: customize the table header
          headerPrefix: "## "
          # Optional: use star emoji (default is ⭐)
          starSymbol: "⭐"

      - name: Commit changes
        uses: stefanzweifel/git-auto-commit-action@v5
        with:
          commit_message: "Update README stars ⭐"
          file_pattern: "README.md"